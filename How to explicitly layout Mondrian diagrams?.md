---Title: How to explicitly layout Mondrian diagrams?---#How to explicitly layout Mondrian diagrams?- [[howto]] [[visualizations]]- #Motivation    - We would like to be able to take a default layout (circle, forced etc), tweak it by hand, and then save the layout so we can regenerate the mondrian with the hand-tweaked layout.- #Mondrian layouts    - Some mondrian examples are here:    - GtExplicitExampleGroup withAll: GtMondrian package gtExamplesAllContained    - Look for examples with explicit layout.    - #gtExample gtPragmas & #explicit: gtSenders    - GtMondrian gtReferences & #explicit: gtSenders    - Doesn't show anything interesting.    - The layout builder class is {{gtClass:name=GtMondrianLayoutBuilder}}.    - The actual layouts are all subclasses of {{gtClass:name=GtGraphLayout}}.- #Repositioning experiment    - We run an example, move the nodes and save the positions.    - graph := GtMondrianClassHierarchyExamples new classHierarchyHorizontalTree    - (graph root children collect: #position) storeString    - positions := ((Array new: 35) at: 1 put: ((363.5@405.90216064453125)); at: 2 put: ((321.5@405.8112515536221)); at: 3 put: ((445.5@397.90216064453125)); at: 4 put: ((384.5@402.90216064453125)); at: 5 put: ((384.5@409.90216064453125)); at: 6 put: ((384.5@416.90216064453125)); at: 7 put: ((384.5@423.90216064453125)); at: 8 put: ((384.5@430.90216064453125)); at: 9 put: ((384.5@437.90216064453125)); at: 10 put: ((384.5@444.90216064453125)); at: 11 put: ((384.5@451.90216064453125)); at: 12 put: ((418.5@455.90216064453125)); at: 13 put: ((384.5@465.90216064453125)); at: 14 put: ((384.5@472.90216064453125)); at: 15 put: ((384.5@479.90216064453125)); at: 16 put: ((384.5@486.90216064453125)); at: 17 put: ((349.5@497.90216064453125)); at: 18 put: ((337.5@367.8567060990767)); at: 19 put: ((368.5@400.64606308355565)); at: 20 put: ((368.5@405.75930350167414)); at: 21 put: ((368.5@408.87835112072173)); at: 22 put: ((368.5@409.7116844540551)); at: 23 put: ((368.5@410.5450177873884)); at: 24 put: ((368.1@410.90216064453125)); at: 25 put: ((367.640625@410.90216064453125)); at: 26 put: ((367.34615384615387@410.90216064453125)); at: 27 put: ((367.1413043478261@410.90216064453125)); at: 28 put: ((368.5@410.6748879172585)); at: 29 put: ((366.875@410.90216064453125)); at: 30 put: ((366.7835820895523@410.90216064453125)); at: 31 put: ((366.7094594594595@410.90216064453125)); at: 32 put: ((366.64814814814815@410.90216064453125)); at: 33 put: ((352.38043478260863@410.90216064453125)); at: 34 put: ((341.7084826762246@372.8567060990767)); at: 35 put: ((325.05389221556885@372.8567060990767)); yourself)    - Now we create a new graph and move the nodes to the saved positions.    - newGraph := GtMondrianClassHierarchyExamples new classHierarchyHorizontalTree.    - newGraph root children withIndexDo: [ :child :n | child relocate: (positions at: n) ].    - newGraph- #Applying it to the Ludo Model hierarchy    - Here's the example we want to reformat.    - diagram := GtLudoCodeDocumentationExamples new modelClassCircleLabeledReferences    - (diagram root children collect: #position) storeString    - positions := ((Array new: 23) at: 1 put: ((428.25@440.40216064453125)); at: 2 put: ((342.25@282.40216064453125)); at: 3 put: ((212.25@271.40216064453125)); at: 4 put: ((275.25@466.40216064453125)); at: 5 put: ((395.25@275.40216064453125)); at: 6 put: ((371.25@347.40216064453125)); at: 7 put: ((173.25@373.40216064453125)); at: 8 put: ((337.25@405.40216064453125)); at: 9 put: ((452.25@349.40216064453125)); at: 10 put: ((429.25@515.4021606445313)); at: 11 put: ((481.4218551090786@375.40216064453125)); at: 12 put: ((412.9895965920554@304.40216064453125)); at: 13 put: ((241.07468297848334@296.40216064453125)); at: 14 put: ((459.3429988861084@304.40216064453125)); at: 15 put: ((269.64599990844727@275.636538385994)); at: 16 put: ((252.97752039019034@296.40216064453125)); at: 17 put: ((266.8829357929719@296.40216064453125)); at: 18 put: ((328.36999893188477@479.6981032171214)); at: 19 put: ((251.53184835203405@402.40216064453125)); at: 20 put: ((328.36999893188477@448.0508989912264)); at: 21 put: ((434.31399917602533@358.567892616377)); at: 22 put: ((251.53184835203405@402.40216064453125)); at: 23 put: ((398.73273805986366@375.40216064453125)); yourself)    - **NB:** we have to reset the layout to Basic to be able to relocate the nodes.    - newDiagram := GtLudoCodeDocumentationExamples new modelClassCircleLabeledReferences.newDiagram layout custom: BlBasicLayout new.newDiagram root children withIndexDo: [ :child :n | child relocate: (positions at: n) ].newDiagram    - We now encapsulate it as an example:    - GtLudoCodeDocumentationExamples new modelClassExplicitLabeledReferences- #IMAD    - [[IMAD]] used some explicit layout.